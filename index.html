<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Message Ema</title>
<style>
:root{
  --bg:#070708; --text:#e9eef2; --muted:#96a0aa;
  --accent:#ff7a18; --accent-2:#ffb56b;
}
body{
  margin:0;font-family:Inter,system-ui,Arial,sans-serif;
  background:linear-gradient(180deg,#050507,var(--bg));
  color:var(--text);
  display:flex;flex-direction:column;align-items:center;padding:24px;min-height:100vh;
}
.container{
  width:100%;max-width:600px;
  background:rgba(255,255,255,0.02);
  border-radius:14px;padding:28px;
  border:1px solid rgba(255,255,255,0.03);
  box-shadow:0 16px 60px rgba(2,6,23,0.6);
}
.title{
  font-size:30px;font-weight:800;margin:0 0 6px;line-height:1.2;
  background:linear-gradient(90deg,#fff 0%,var(--accent-2)40%,var(--accent)100%);
  -webkit-background-clip:text;background-clip:text;color:transparent;
  text-shadow:0 8px 30px rgba(255,122,24,0.06)
}
.lead{margin:6px 0 18px;color:var(--muted);font-size:14px}
.input-row{display:flex;gap:12px;align-items:center;margin-bottom:12px;position:relative;}
.real-input{
  flex:1;padding:12px 14px;border-radius:10px;border:1px solid rgba(255,255,255,0.04);
  background:rgba(255,255,255,0.02);color:var(--text);font-size:15px;
  caret-color:var(--accent);
}
.btn{height:48px;padding:0 18px;border-radius:12px;border:0;cursor:pointer;
  background:linear-gradient(180deg,var(--accent),var(--accent-2));
  color:#051014;font-weight:800;position:relative;box-shadow:0 14px 36px rgba(255,122,24,0.12)}
.btn:active{transform:translateY(-2px) scale(.996)}
#status{min-height:28px;margin-top:10px;font-weight:700;color:var(--muted);font-size:14px}
.hint{margin-top:12px;color:var(--muted);font-size:13px;padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.01);background:rgba(255,255,255,0.01)}
a#back{display:inline-block;margin-bottom:12px;color:var(--accent);text-decoration:none;font-weight:700;}
label{display:flex;align-items:center;gap:8px;margin-bottom:12px;font-size:13px;color:var(--muted);}
</style>
</head>
<body>
<div class="container">
  <a href="#" id="back" onclick="window.location.reload()">‚Üê Retour</a>
  <h1 class="title">Message Ema</h1>
  <p class="lead">Entre le mot de passe pour voir le message</p>

  <label><input type="checkbox" id="show">Afficher le mot de passe</label>
  <div class="input-row">
    <input id="real" class="real-input" type="password" autocomplete="one-time-code" aria-label="mot de passe">
    <button id="submit" class="btn">Valider</button>
  </div>

  <div id="status"></div>
  <div class="hint">
    <strong>Indice :</strong> C'est mon pr√©nom avec une majuscule, il y a ensuite / puis ma date de naissance, un / puis le pr√©nom avec une majuscule d'une personne que j'aime, puis encore un /, le pr√©nom de mon chat avec une majuscule, la 24e lettre de l'alphabet et un !<br>
    <em>exemple : Gilbert/1983/Gabriel/ProutG!</em>
  </div>
</div>

<script>
const API = 'https://pearlier-captivatingly-so.ngrok-free.dev';
const real = document.getElementById('real');
const submit = document.getElementById('submit');
const status = document.getElementById('status');
const show = document.getElementById('show');

show.addEventListener('change', ()=>{ real.type = show.checked ? 'text' : 'password'; });

submit.addEventListener('click', async ()=>{ await sendPassword(); });
real.addEventListener('keydown', async (e)=>{ if(e.key==='Enter') await sendPassword(); });

async function sendPassword(){
  const code = real.value;
  if(!code){status.textContent='Entre un mot de passe.'; return;}
  status.textContent='V√©rification...';
  try{
    const res = await fetch(API+'/auth',{
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body:JSON.stringify({ code })
    });
    const j = await res.json();
    if(res.ok && j.ok){
      if(j.admin) sessionStorage.setItem('admin_logged','true');
      sessionStorage.setItem('private_secret', j.secret);
      window.location.href = j.admin?'admin.html':'secret.html';
    } else {
      status.textContent=j.error || 'Code incorrect üòâ';
    }
  }catch(err){status.textContent='Erreur r√©seau';}
}
</script>
</body>
</html>
